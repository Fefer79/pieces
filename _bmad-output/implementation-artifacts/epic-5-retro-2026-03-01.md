# Rétrospective Epic 5 : Livraison & Logistique

**Date :** 2026-03-01
**Epic :** 5 — Livraison & Logistique
**Statut :** Complète (5/5 stories done)
**Rétrospective précédente :** Epic 4 (2026-03-01)

---

## Résumé Epic

| Métrique | Valeur |
|----------|--------|
| Stories complétées | 5/5 (100%) |
| Tests en fin d'epic | 260+ |
| Fonctionnalités clés | Assignation rider, tracking temps réel, COD, SLA, protocole absent |

## Ce qui a bien marché

### 1. Module delivery complet
- Modèle Delivery avec statuts (ASSIGNED → PICKED_UP → IN_TRANSIT → DELIVERED → CONFIRMED)
- Assignation manuelle rider (admin ou système)
- Interface mission avec adresse, pièce, mode paiement, montant

### 2. Suivi temps réel via SSE
- Server-Sent Events pour tracking rider
- Estimation délai basée sur distance
- Express ≤1h30, Standard ≤24h

### 3. Collecte paiement COD
- Rider enregistre paiement + photo reçu
- Escalade si incident paiement
- Fallback mode paiement alternatif

### 4. Gestion SLA automatisée
- Auto-crédit si Express dépasse SLA
- Confirmation active 30 min post-livraison
- Notifications automatiques à chaque étape

### 5. Protocole client absent
- Tentative échouée documentée
- Procédure de relivraison
- Gestion dépôt temporaire

## Défis et difficultés

### 1. Coordination état commande ↔ livraison
- State machine Order et Delivery doivent rester synchronisées
- Transitions commande déclenchées par événements livraison
- Complexité testable mais nécessitant attention

### 2. Tracking GPS simplifié
- Pas de tracking temps réel GPS natif au MVP
- Coordonnées basées sur adresse, pas sur position rider en mouvement
- SSE pour mise à jour statut, pas position continue

### 3. Tests d'intégration multi-modules
- Delivery dépend de Order, Payment, et User
- Mocks nombreux et interdépendants
- Pattern de test route bien établi mais verbeux

## Insights clés

1. **SSE est plus léger que WebSocket** pour le tracking unidirectionnel — bon choix MVP
2. **La synchronisation Order ↔ Delivery** est le point le plus fragile — bien tester les transitions croisées
3. **Le protocole client absent** est un edge case critique pour l'Afrique de l'Ouest — adresses souvent approximatives
4. **Le SLA auto-crédit** construit la confiance acheteur rapidement

## Dette technique

| Item | Priorité | Notes |
|------|----------|-------|
| Tracking GPS temps réel rider | Medium | Phase 2 avec app rider dédiée |
| Optimisation routes livraison | Low | Volume MVP ne justifie pas |
| Notifications SMS fallback | Medium | Implémenté Epic 8 |

## Préparation Epic 6

- ✅ Delivery model avec workflow complet
- ✅ SSE tracking opérationnel
- ✅ COD et paiement mobile intégrés
- À créer : WhatsApp webhook infrastructure
- À créer : Intégration Gemini VLM pour photos WhatsApp

---

*Rétrospective facilitée par Bob (Scrum Master) — générée le 2026-03-01*
