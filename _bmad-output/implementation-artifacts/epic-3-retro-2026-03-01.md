# Rétrospective Epic 3 : Recherche & Navigation Pièces (PWA)

**Date :** 2026-03-01
**Epic :** 3 — Recherche & Navigation Pièces (PWA)
**Statut :** Complète (6/6 stories done)
**Rétrospective précédente :** Epic 2 (2026-03-01)

---

## Résumé Epic

| Métrique | Valeur |
|----------|--------|
| Stories complétées | 6/6 (100%) |
| Tests totaux en fin d'epic | 185+ |
| Fonctionnalités clés | Navigation visuelle, recherche pg_trgm, VIN decode, profils véhicules, vision IA, PWA offline |

## Ce qui a bien marché

### 1. Navigation drill-down complète
- Brand → Model → Year → Category — navigation visuelle intuitive
- API publiques (pas d'auth requise) pour le browsing
- Filtrage par zones de livraison vendeur

### 2. Recherche PostgreSQL native performante
- pg_trgm + unaccent pour recherche fuzzy sans Meilisearch
- search_synonyms table (~30 entrées seed) pour correction typos
- Suffisant pour le volume MVP

### 3. Identification par photo IA
- Gemini VLM pour identification visuelle de pièces
- Désambiguïsation quand plusieurs pièces possibles
- Principe "Zero Impasse" avec escalade humaine

### 4. Profils véhicules utilisateur
- Gestion de multiples véhicules par utilisateur
- Pré-remplissage du dernier véhicule utilisé
- VIN decoding via NHTSA VPIC API

## Défis et difficultés

### 1. Données statiques véhicules
- Marques/modèles/années en fichier constants (pas en DB)
- Décision architecturale correcte pour le MVP mais limitante à terme

### 2. Meilisearch différé
- pg_trgm suffisant pour le volume actuel
- Seuil de migration : >50K références ou >15% recherches sans résultat

### 3. Service Worker (Serwist) complexité
- PWA offline-first nécessite gestion cache stratégique
- Precaching des assets statiques + network-first pour API

## Insights clés

1. **pg_trgm + unaccent** offre une recherche fuzzy suffisante sans infrastructure externe
2. **Les données statiques en constants** simplifient le déploiement mais compliquent les mises à jour
3. **Le VIN decoding** via API externe est fiable mais nécessite fallback manuel
4. **L'identification photo IA** doit toujours offrir une désambiguïsation humaine

## Dette technique

| Item | Priorité | Notes |
|------|----------|-------|
| Meilisearch migration | Medium | Quand volume dépasse seuils |
| Données véhicules en DB | Low | Constants suffisants pour MVP |
| Service Worker cache strategy | Medium | À affiner avec usage réel |

## Préparation Epic 4

- ✅ Catalogue navigable et cherchable
- ✅ Profils véhicules avec pré-remplissage
- ✅ Identification IA fonctionnelle
- À créer : State machine commande (10 états)
- À créer : Intégration CinetPay

---

*Rétrospective facilitée par Bob (Scrum Master) — générée le 2026-03-01*
